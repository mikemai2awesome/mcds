---
interface Props {
  label: string;
  id: string;
  name: string;
  checked?: boolean;
}

const { label, id, name, checked = false } = Astro.props;
---

<div class="mc-switch">
  <input
    type="checkbox"
    role="switch"
    class="mc-switch__input"
    id={id}
    name={name}
    checked={checked}
  />
  <span class="mc-switch__control" aria-hidden="true"></span>
  <label for={id} class="mc-switch__label">{label}</label>
</div>

<style>
  @layer components {
    .mc-switch {
      --_circle-size: 3cap;
      --_border-size: 2px;
      display: inline-flex;
      align-items: center;
      position: relative;
    }

    .mc-switch__input {
      position: absolute;
      inset-block-start: 0;
      inset-inline-start: 0;
      inline-size: calc(var(--_circle-size) * 2 - 1ch);
      block-size: 100%;
      appearance: none;
      border: 0;
    }

    .mc-switch__control {
      position: relative;
      display: inline-block;
      inline-size: calc(var(--_circle-size) * 2);
      block-size: calc(var(--_circle-size));
      background-color: crimson;
      border: var(--_border-size) solid;
      border-radius: 100em;
      transition: background-color var(--transition);
      pointer-events: none;
    }

    @media (prefers-reduced-motion: no-preference) {
      .mc-switch__control {
        transition: background-color var(--transition);
      }
    }

    .mc-switch__control::before {
      content: "";
      position: absolute;
      inset-block-start: calc(var(--_border-size) * -1);
      inset-inline-end: calc(var(--_border-size) * -1);
      inline-size: var(--_circle-size);
      block-size: var(--_circle-size);
      background-color: canvas;
      border: calc(var(--_border-size) * 1) solid;
      border-radius: 100em;
    }

    @media (prefers-reduced-motion: no-preference) {
      .mc-switch__control::before {
        transition: transform var(--transition);
      }

      .mc-switch__input:checked + .mc-switch__control::before {
        transform: translateX(-100%);
      }
    }

    .mc-switch__input:checked + .mc-switch__control {
      background-color: transparent;
    }

    .mc-switch__label {
      margin-inline-start: calc(var(--gutter) / 4);
      font: inherit;
    }
  }
</style>

<script>
  // Optionally add JavaScript for advanced functionality
  document.addEventListener("DOMContentLoaded", () => {
    const switches = document.querySelectorAll(".mc-switch__input");

    switches.forEach((switchInput) => {
      (switchInput as HTMLInputElement).addEventListener("change", () => {
        // You could trigger events or store state here
        const isChecked = (switchInput as HTMLInputElement).checked;
        const switchId = (switchInput as HTMLInputElement).id;

        // Example: Dispatch a custom event
        const event = new CustomEvent("switch-change", {
          detail: { id: switchId, checked: isChecked },
        });
        document.dispatchEvent(event);
      });
    });
  });
</script>
